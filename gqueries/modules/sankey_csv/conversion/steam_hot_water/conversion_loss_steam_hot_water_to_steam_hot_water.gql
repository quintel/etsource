# The treat as loss check adds unused heat to the losses
# The steam hot water check is to ensure it only applies to steam hot water edges

- query =
    DIVIDE(
      SUM(
        V(
          FILTER(G(sankey_conversion_group),"steam_hot_water_output_conversion > 0.0 && steam_hot_water_input_conversion > 0.0"),
          "steam_hot_water_output_conversion * steam_hot_water_input_conversion / (1 - loss_output_conversion) * output_of_loss"
        ),
        V(INPUT_EDGES(ALL(),"treat_as_loss? && steam_hot_water?"),demand)
      ),
      BILLIONS
    )
- unit = PJ
