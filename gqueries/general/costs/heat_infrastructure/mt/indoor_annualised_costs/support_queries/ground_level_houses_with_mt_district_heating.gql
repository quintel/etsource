- query = 
    SUM( 
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_before_1945,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_before_1945,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_1945_1964,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_1945_1964,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_1965_1984,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_1965_1984,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_1985_2004,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_1985_2004,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_2005_present,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_2005_present,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_terraced_houses_future,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_terraced_houses_future,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_before_1945,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_before_1945,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_1945_1964,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_1945_1964,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_1965_1984,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_1965_1984,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_1985_2004,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_1985_2004,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_2005_present,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_2005_present,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_semi_detached_houses_future,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_semi_detached_houses_future,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_before_1945,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_before_1945,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_1945_1964,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_1945_1964,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_1965_1984,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_1965_1984,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_1985_2004,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_1985_2004,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_2005_present,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_2005_present,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          ),
        PRODUCT(
            V(households_useful_demand_for_space_heating_detached_houses_future,number_of_units), 
            V(EDGE(households_useful_demand_for_space_heating_detached_houses_future,households_space_heater_district_heating_mt_steam_hot_water_aggregator),share)
          )
        )
- unit =